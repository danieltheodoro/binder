#!/bin/bash
set -eux

# Instalação de kernels

# Bash
python3 -m bash_kernel.install

# IJavascript
npm install -g ijavascript
ijsinstall --install=local
ijsinstall --install=local || true

# Octave
python3 -m octave_kernel.install || true

# R
R -e "install.packages('IRkernel', repos='http://cran.us.r-project.org')" || true
R -e "IRkernel::installspec(user = TRUE)" || true

# Julia
julia -e 'using Pkg; Pkg.add("IJulia")' || true

# Kotlin
python3 -m kotlin_kernel.install || true

# Go (gophernotes)
go install github.com/gopherdata/gophernotes@latest || true
mkdir -p ~/.local/share/jupyter/kernels/gophernotes
cp -r "$(go env GOPATH)/pkg/mod/github.com/gopherdata/gophernotes@*/kernel"/* ~/.local/share/jupyter/kernels/gophernotes || true

# C# com dotnet interactive
dotnet tool install --global Microsoft.dotnet-interactive || true
export PATH="$PATH:$HOME/.dotnet/tools"
yes | dotnet interactive jupyter install --path ~/.local/share/jupyter/kernels || true

# Haskell
stack install ihaskell || true
ihaskell install --prefix ~/.local || true

# OCaml
opam install -y jupyter || true
eval $(opam env)
jupyter kernelspec install --user $(opam var jupyter-share)/kernels/ocaml || true

# Elixir
git clone https://github.com/pprzetacznik/IElixir.git || true
cd IElixir
mix deps.get || true
MIX_ENV=prod mix compile || true
mix install || true
cd ..

# Swift (apenas local ou docker custom)
echo "⚠️ Swift kernel não suportado oficialmente via Binder. Requer imagem customizada." || true

# Dart
echo "⚠️ Dart kernel requer setup extra. Ignorando no Binder." || true

# PHP
echo "⚠️ PHP kernel não suportado via Binder com conda/pip. Requer setup extra." || true

# Lua, Nim, Zig, Perl, F#, Typescript
echo "⚠️ Estas linguagens requerem instalação e configuração de kernels customizados." || true

#!/bin/bash
set -eux

# Bash
python3 -m bash_kernel.install

# Go (gophernotes)
echo "Instalando e registrando kernel de Go (gophernotes)..."
git clone --depth=1 https://github.com/gopherdata/gophernotes.git /tmp/gophernotes
cd /tmp/gophernotes
go install
mkdir -p ~/.local/share/jupyter/kernels/gophernotes
cp -r kernel/* ~/.local/share/jupyter/kernels/gophernotes
cd -


# R já vem configurado pelo conda + r-irkernel

# Node.js / JavaScript
echo "Instalando kernel de JavaScript (IJavascript)..."
npm install -g ijavascript
ijsinstall --install=local

# Corrigindo permissões de kernels (se necessário)
chmod -R 755 ~/.local/share/jupyter/kernels

echo "Registrando kernel do Julia..."
julia -e 'import Pkg; Pkg.add("IJulia"); using IJulia; installkernel("Julia")'

echo "Registrando kernel do Octave..."
python3 -m pip install --upgrade --force-reinstall octave_kernel

#!/bin/bash
set -e

echo "🔧 Atualizando APT e instalando dependências..."
apt-get update || true
apt-get install -y curl git unzip build-essential pkg-config libzmq3-dev \
    php-cli php-pear perl cpanminus luarocks lua5.3 lua5.3-dev \
    libmagic-dev zlib1g-dev libgmp-dev libtinfo-dev libsqlite3-dev || true

echo "📦 Registrando kernel fake de Rust..."
mkdir -p $HOME/.local/share/jupyter/kernels/rust
cat <<EOF > $HOME/.local/share/jupyter/kernels/rust/kernel.json
{
  "argv": ["bash", "-c", "rustc {connection_file} && ./main"],
  "display_name": "Rust (wrapper)",
  "language": "rust"
}
EOF

# Zig (via wrapper)
echo "⚙️ Registrando kernel fake do Zig..."
mkdir -p ~/.local/share/jupyter/kernels/zig

cat > ~/.local/share/jupyter/kernels/zig/kernel.json <<EOF
{
  "argv": ["bash", "-c", "zig run {connection_file}"],
  "display_name": "Zig (wrapper)",
  "language": "zig"
}
EOF

# --------------------
# PHP
# --------------------
echo "⚙️ Instalando kernel do PHP..."
git clone https://github.com/Litipk/Jupyter-PHP-Installer.git /tmp/phpkernel
cd /tmp/phpkernel && ./install.sh || true
cd -

# --------------------
# Perl (IPerl)
# --------------------
echo "⚙️ Instalando kernel do Perl..."
cpanm Devel::IPerl || true
iperl install || true

# --------------------
# Lua (iLua)
# --------------------
echo "⚙️ Instalando kernel do Lua..."
git clone https://github.com/FrigoEU/iLua.git /tmp/ilua
cd /tmp/ilua && luarocks make || true
./install.lua || true
cd -

echo "Todos os kernels possíveis foram processados."
